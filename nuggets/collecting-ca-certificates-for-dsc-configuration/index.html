<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin SEO -->









<title>Collecting CA Certificates for DSC Configuration - PowerShell Journey</title>




<meta name="description" content="Best practice is to use individual certificates for each Node for DSC. While you can use auto enrollment, getting the certificates to where the MOF are build can be a problem. This is one solution">




<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="PowerShell Journey">
<meta property="og:title" content="Collecting CA Certificates for DSC Configuration">


  <link rel="canonical" href="https://blog.bladefirelight.com/nuggets/collecting-ca-certificates-for-dsc-configuration/">
  <meta property="og:url" content="https://blog.bladefirelight.com/nuggets/collecting-ca-certificates-for-dsc-configuration/">



  <meta property="og:description" content="Best practice is to use individual certificates for each Node for DSC. While you can use auto enrollment, getting the certificates to where the MOF are build can be a problem. This is one solution">



  <meta name="twitter:site" content="@BladeFireLight">
  <meta name="twitter:title" content="Collecting CA Certificates for DSC Configuration">
  <meta name="twitter:description" content="Best practice is to use individual certificates for each Node for DSC. While you can use auto enrollment, getting the certificates to where the MOF are build can be a problem. This is one solution">
  <meta name="twitter:url" content="https://blog.bladefirelight.com/nuggets/collecting-ca-certificates-for-dsc-configuration/">

  
    <meta name="twitter:card" content="summary">
    
  

  



  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2017-04-21T00:00:00-05:00">








  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "David Jones",
      "url" : "https://blog.bladefirelight.com",
      "sameAs" : null
    }
  </script>






<!-- end SEO -->


<link href="https://blog.bladefirelight.com/feed.xml" type="application/atom+xml" rel="alternate" title="PowerShell Journey Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="https://blog.bladefirelight.com/assets/css/main.css">

<meta http-equiv="cleartype" content="on">
    <!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->
  </head>

  <body class="layout--single">

    <!--[if lt IE 11]>
<div class="notice__danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg"><a href="https://blog.bladefirelight.com/">PowerShell Journey</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://blog.bladefirelight.com/about/">About</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://blog.bladefirelight.com/nuggets/">Nuggets</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://blog.bladefirelight.com/windowsimagetools/">Windows Image Tools</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://blog.bladefirelight.com/windowsimagetools/">PKI Tools</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://blog.bladefirelight.com/year-archive/">Archive by Date</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://blog.bladefirelight.com/categories/">By Category</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://blog.bladefirelight.com/tags/">By Tag</a></li>
          
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="http://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
          <a href="https://blog.bladefirelight.com/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
          <a href="https://blog.bladefirelight.com/nuggets" itemprop="item"><span itemprop="name">Nuggets</span></a>
          <meta itemprop="position" content="2" />
        </li>
        <span class="sep">/</span>
      
    
      
      
        <li class="current">Collecting CA Certificates for DSC Configuration</li>
      
    
  </ol>
</nav>
  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  

<div itemscope itemtype="http://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="https://blog.bladefirelight.com/assets/images/avatar1.jpg" class="author__avatar" alt="David Jones" itemprop="image">
      
    </div>
  

  <div class="author__content">
    <h3 class="author__name" itemprop="name">David Jones</h3>
    
      <p class="author__bio" itemprop="description">
        20 years IT Pro. life long student of tech
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="http://schema.org/Place">
          <i class="fa fa-fw fa-map-marker" aria-hidden="true"></i> <span itemprop="name">Gretna, NE</span>
        </li>
      

      

      
        <li>
          <a href="mailto:BladeFireLight@outlook.com">
            <meta itemprop="email" content="BladeFireLight@outlook.com" />
            <i class="fa fa-fw fa-envelope-square" aria-hidden="true"></i> Email
          </a>
        </li>
      

      

      
        <li>
          <a href="https://twitter.com/BladeFireLight" itemprop="sameAs">
            <i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter
          </a>
        </li>
      

      

      

      

      

      

      

      

      
        <li>
          <a href="https://github.com/BladeFireLight" itemprop="sameAs">
            <i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs">
      <i class="fa fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Collecting CA Certificates for DSC Configuration">
    <meta itemprop="description" content="Best practice is to use individual certificates for each Node for DSC. While you can use auto enrollment, getting the certificates to where the MOF are build can be a problem. This is one solution">
    <meta itemprop="datePublished" content="April 21, 2017">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">Collecting CA Certificates for DSC Configuration
</h1>
          
            <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 




  4 minute read
</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        <h2 id="the-goal">The Goal</h2>

<p>Microsoft PFE Ashely McGlone <a href="https://blogs.msdn.microsoft.com/powershell/2015/10/01/powershell-dsc-faq-sorting-out-certificates/">recommends</a> that each node managed by DSC (Desired State Configuration) have unique certificate for protecting credentials.</p>

<p><img src="https://blog.bladefirelight.com/assets/images/MofCredSecurity.png" alt="Mof Credential Security Chart" /></p>

<p class="notice--info">Starting in WMF 5.0 .MOF are <a href="https://msdn.microsoft.com/en-us/powershell/wmf/5.0/dsc_encryptedmof">encrypted at rest</a> on the Node by . But that is not the case for the file on the pull server. So I’m going on the assumption that this is still a best practice.</p>

<p>The problem with that is getting the certificates either from the node or from a CA (Certificate Authority) to the DSC development workstation or CI/CD (Continuous Integration/Continuous Deployment) server. I’m going to cover one method.</p>

<h2 id="pre-requisites">Pre-requisites</h2>

<p>For this I’m going to be using <a href="https://github.com/theJasonHelmick/PS-AutoLab-Env">PowerShell Automated Lab Environment</a> and it’s Configuration called “devops-powershell-fundamentals”</p>

<p>This will generate the following:</p>

<ol>
  <li>DC1 - Domain Controller and Certificate Authority</li>
  <li>S1, S2 - Member servers</li>
  <li>N1 - Nano server (not used)</li>
  <li>Cli1 - Windows 10 workstation</li>
  <li>NAT virtual switch and static IP’s</li>
  <li>Certificate Template called “DSC Template”</li>
  <li>Auto-Enrollment GPO</li>
</ol>

<p>Once that is up and running we can connect to cli1 via PowerShell Direct</p>

<h2 id="demo">Demo</h2>

<p>I’m going to start with installing PKITools from the PowerShell Gallery  (and selecting Yes to install NuGet and allow use of untrusted rpo, this is new lab after all)</p>

<figure class="highlight"><pre><code class="language-powershell" data-lang="powershell">Install-Module PKITools
<span class="nb">Get-Command</span> -Module PkiTools

CommandType     Name                                               Version    Source
-----------     ----                                               -------    ------
<span class="k">Function        </span>Get-ADCertificateTemplate                          1.6        PkiTools
<span class="k">Function        </span>Get-CaLocationString                               1.6        PkiTools
<span class="k">Function        </span>Get-CertificatAuthority                            1.6        PkiTools
<span class="k">Function        </span>Get-CertificateTemplateOID                         1.6        PkiTools
<span class="k">Function        </span>Get-IssuedCertificate                              1.6        PkiTools</code></pre></figure>

<p>The one I want to focus on is Get-IssuedCertificate. As part of a DSC build process I want to collect the public certificates for each node. Pulling the certificate from each node is one option, but not practical in large network, and may not even be be possible due to lack of connectivity. Thankfully all the public certificates also reside on the Certificate Authority that issues them.</p>

<p>In our lab there is only one domain and one CA (also the DC. no not do that in production) So the code will be simple.</p>

<p>First lets look at the parameters.</p>

<figure class="highlight"><pre><code class="language-powershell" data-lang="powershell">SYNTAX
    Get-IssuedCertificate <span class="o">[[</span>-ExpireInDays] &lt;Int32&gt;] <span class="o">[[</span>-CAlocation] &lt;<span class="kt">String</span><span class="o">[]</span>&gt;] <span class="o">[[</span>-Properties] &lt;<span class="kt">String</span><span class="o">[]</span>&gt;]
    <span class="o">[[</span>-CertificateTemplateOid] &lt;<span class="kt">String</span>&gt;] <span class="o">[[</span>-CommonName] &lt;<span class="kt">String</span>&gt;] <span class="o">[[</span>-Credential] &lt;PSCredential&gt;] <span class="o">[</span>&lt;CommonParameters&gt;]</code></pre></figure>

<p>No parameters are required. lets see what it does</p>

<figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="o">[</span>hv01]: <span class="o">[</span>Cli1]: <span class="nb">PS </span>C:<span class="se">\&gt;</span> Get-IssuedCertificate


Issued Common Name          :
Certificate Expiration Date : 4/18/2018 3:40:05 AM
Certificate Effective Date  : 4/18/2017 3:40:05 AM
Certificate Template        : 1.3.6.1.4.1.311.21.8.8376484.9891361.12404633.14452813.1016466.111.1.29
Issued Request ID           : 2
Certificate Hash            : f2 4e db 00 12 19 68 79 98 0b 6a 95 47 6d 7a c6 a7 40 e7 63
Request Disposition Message : Issued
Requester Name              : COMPANY<span class="se">\D</span>C1<span class="err">$</span>
Binary Certificate          : -----BEGIN CERTIFICATE-----
                              MIIF6jCCBNKgAwIBAgITUQAAAAL5xXyLo72OVAAAAAAAAjANBgkqhkiG9w0BAQsF
                              ADBZMRAwDgYDVQQKEwdDb21wYW55MRAwDgYDVQQIEwdBcml6b25hMRAwDgYDVQQH
                              EwdQaG9lbml4MQswCQYDVQQGEwJVUzEUMBIGA1UEAxMLQ29tcGFueS5QcmkwHhcN
                              MTcwNDE4MDM0MDA1WhcNMTgwNDE4MDM0MDA1WjAAMIIBIjANBgkqhkiG9w0BAQEF
                              AAOCAQ8AMIIBCgKCAQEAxjtOVDCixBoUEOWG1WKwPqw0DY77upmE0E4Bfc6CV94g
                              X5ewYtagk7f8KvfigDaoq20qCNzFfaBprseL/0JoKPBY05Ws9O98pfAP639MGP6U
                              MCbgXZ8ILhtoWZCqHi+S8UVyu7D2meyyl54IgeoVcb0MBISWoGyyJ5tzAWYX1XQL
                              /0tnQ4YoWRcJulW7Qvn0kUhk6ooe9Mot4gCD0jPE/QjJ/loJDHO+aCRxsMwEil87
                              KqGKfEcS54dV+g6wRhgxlrfi8b1NDwhKcpgglSzhtmBEUY72m1S5AxuL7V90ZxNU
                              NQ/CBboy98NKri8RbmyvypAQ47MMyadVVmPLsAgGJwIDAQABo4IDAjCCAv4wNgYJ
                              KwYBBAGCNxUHBCkwJwYfKwYBBAGCNxUIg/+hJITb3CGF9Y8ZhvKQTb6FEm8BHQIB
                              cwIBADAUBgNVHSUEDTALBgkrBgEEAYI3FRMwDgYDVR0PAQH/BAQDAgWgMBwGCSsG
                              AQQBgjcVCgQPMA0wCwYJKwYBBAGCNxUTMHgGCSqGSIb3DQEJDwRrMGkwDgYIKoZI
                              hvcNAwICAgCAMA4GCCqGSIb3DQMEAgIAgDALBglghkgBZQMEASowCwYJYIZIAWUD
                              BAEtMAsGCWCGSAFlAwQBAjALBglghkgBZQMEAQUwBwYFKw4DAgcwCgYIKoZIhvcN
                              AwcwHQYDVR0OBBYEFOB1zbkBT8m9NW7DRh7xW13OjSmLMB8GA1UdIwQYMBaAFA+9
                              p4ww6yyPs/vD4ugUNRM24pWIMIHFBgNVHR8Egb0wgbowgbeggbSggbGGga5sZGFw
                              Oi8vL0NOPUNvbXBhbnkuUHJpLENOPURDMSxDTj1DRFAsQ049UHVibGljJTIwS2V5
                              JTIwU2VydmljZXMsQ049U2VydmljZXMsQ049Q29uZmlndXJhdGlvbixEQz1Db21w
                              YW55LERDPVByaT9jZXJ0aWZpY2F0ZVJldm9jYXRpb25MaXN0P2Jhc2U/b2JqZWN0
                              Q2xhc3M9Y1JMRGlzdHJpYnV0aW9uUG9pbnQwgb0GCCsGAQUFBwEBBIGwMIGtMIGq
                              BggrBgEFBQcwAoaBnWxkYXA6Ly8vQ049Q29tcGFueS5QcmksQ049QUlBLENOPVB1
                              YmxpYyUyMEtleSUyMFNlcnZpY2VzLENOPVNlcnZpY2VzLENOPUNvbmZpZ3VyYXRp
                              b24sREM9Q29tcGFueSxEQz1Qcmk/Y0FDZXJ0aWZpY2F0ZT9iYXNlP29iamVjdENs
                              YXNzPWNlcnRpZmljYXRpb25BdXRob3JpdHkwPgYDVR0RAQH/BDQwMqAfBgkrBgEE
                              AYI3GQGgEgQQezARELeYdUOiN2P2QTxNl4IPREMxLkNvbXBhbnkuUHJpMA0GCSqG
                              SIb3DQEBCwUAA4IBAQBCV12I9eIaFLRFsgzbhMizfufvtCOI/EKAOsEYCxI9HFKJ
                              H2HfC0lh7eEZABFQKPNx8XgCHCm5skzdR5oHLbtTwrnky2YJkFnuNOgTF/tuunoU
                              p3+X0Kk3YH88wrv+YPE37PtqF/fJnZvEUzPfxRiaiOFaTisEIXfAxTvVYVBSwK9H
                              oSgH5GTEblvlmiw6LD7JZYqrmYFCPQdB/mj+aOPjyeFClneGH2u8sxKCZHiJ/RWX
                              wQJn8DO5ACctnLC8mH70HR5vVRJ0yFX6vrpnRyJEBSpawAYFK1vPf7Wks+gLSw4q
                              g7ASEJG/MJK0oJpBosOKKGr+jMnEx6BTs1NJ3d0l
                              -----END CERTIFICATE-----

PSComputerName              : DC1.Company.Pri
RunspaceId                  : 146e5d7a-b85a-4540-9360-fea7413a9978

Issued Common Name          :
Certificate Expiration Date : 4/18/2018 3:40:07 AM
Certificate Effective Date  : 4/18/2017 3:40:07 AM
Certificate Template        : 1.3.6.1.4.1.311.21.8.8376484.9891361.12404633.14452813.1016466.111.1.28

~~~~~~~~SNIP~~~~~~~~~~~~~

                              BgkrBgEEAYI3UAEwHQYDVR0OBBYEFKYaQhzh28O8Sy4jBG5/63E59OzBMB8GA1Ud
                              IwQYMBaAFA+9p4ww6yyPs/vD4ugUNRM24pWIMIHFBgNVHR8Egb0wgbowgbeggbSg
                              gbGGga5sZGFwOi8vL0NOPUNvbXBhbnkuUHJpLENOPURDMSxDTj1DRFAsQ049UHVi
                              bGljJTIwS2V5JTIwU2VydmljZXMsQ049U2VydmljZXMsQ049Q29uZmlndXJhdGlv
                              bixEQz1Db21wYW55LERDPVByaT9jZXJ0aWZpY2F0ZVJldm9jYXRpb25MaXN0P2Jh
                              c2U/b2JqZWN0Q2xhc3M9Y1JMRGlzdHJpYnV0aW9uUG9pbnQwgb0GCCsGAQUFBwEB
                              BIGwMIGtMIGqBggrBgEFBQcwAoaBnWxkYXA6Ly8vQ049Q29tcGFueS5QcmksQ049
                              QUlBLENOPVB1YmxpYyUyMEtleSUyMFNlcnZpY2VzLENOPVNlcnZpY2VzLENOPUNv
                              bmZpZ3VyYXRpb24sREM9Q29tcGFueSxEQz1Qcmk/Y0FDZXJ0aWZpY2F0ZT9iYXNl
                              P29iamVjdENsYXNzPWNlcnRpZmljYXRpb25BdXRob3JpdHkwGwYDVR0RBBQwEoIQ
                              Q2xpMS5Db21wYW55LlByaTANBgkqhkiG9w0BAQsFAAOCAQEAFt8fD8dq7WdYxldl
                              648SS8KkqEeqUv4cBXt5/GBLBO/Cr7JB1m5K8U3VrjzwMgyU4n01h0xeJxYeHIvA
                              WZ1Fy8BXSzurH3MOcbC0jKuqezzXAJIpVAfkHB0UBKx+OnZes21aGXjb0ZHTv+lv
                              3lx6Wrc051RD+eDDLz0/+kLU6MRgJHTO8qlgRDRjRSqU7dcU1TKFmpij1IzWjvJb
                              GU2qHCfAnhWr8b+lMjvRMXkBxQjRF9kmMdhQxhR+nWN0/056wpr7/bukwGzPBKAU
                              HfFNFXqNT8nc79rB7IW4T6xZteEm0zG/TTNpIjL74/MGDBzFG3MTDE3i6ks9DoF/
                              <span class="nv">9XDyDg</span><span class="o">==</span>
                              -----END CERTIFICATE-----

PSComputerName              : DC1.Company.Pri
RunspaceId                  : 146e5d7a-b85a-4540-9360-fea7413a9978</code></pre></figure>

<p>That got every issued certificate for every CA on the current domain. More then I need. Obviously we need to trim that down to just the DSC certificates. for that we will need to specify -CertificateTemplateOID. Lets look at the help for that parameter.</p>

<figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="o">[</span>hv01]: <span class="o">[</span>Cli1]: <span class="nb">PS </span>C:<span class="se">\&gt;</span> <span class="nb">help </span>Get-IssuedCertificate -Parameter CertificateTemplateOid

-CertificateTemplateOid &lt;<span class="kt">String</span>&gt;
    <span class="k">Filter </span>on Certificate Template OID <span class="o">(</span>use Get-CertificateTemplateOID<span class="o">)</span>

    Required?                    <span class="nb">false
    </span>Position?                    4
    Default value
    Accept pipeline input?       <span class="nb">false
    </span>Accept wildcard characters?  <span class="nb">false</span></code></pre></figure>

<p>Good it has a function to get the OID lets look at that.</p>

<figure class="highlight"><pre><code class="language-powershell" data-lang="powershell">SYNTAX
    Get-CertificateTemplateOID <span class="o">[</span>-Name] &lt;<span class="kt">String</span>&gt; <span class="o">[[</span>-Domain] &lt;<span class="kt">String</span>&gt;] <span class="o">[</span>-WhatIf] <span class="o">[</span>-Confirm] <span class="o">[</span>&lt;CommonParameters&gt;]</code></pre></figure>

<p>Only the -Name is required. That I know.</p>

<figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="o">[</span>hv01]: <span class="o">[</span>Cli1]: <span class="nb">PS </span>C:<span class="se">\&gt;</span> Get-CertificateTemplateOID DSCTemplate
1.3.6.1.4.1.311.21.8.16187918.14945684.15749023.11519519.4925321.197.13392998.8282280</code></pre></figure>

<p>And I though GUIDS were an eye full.</p>

<p>Get-IssuedCertificate also has a -Propterties paramaters lets look at that.</p>

<figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="o">[</span>hv01]: <span class="o">[</span>Cli1]: <span class="nb">PS </span>C:<span class="se">\&gt;</span> <span class="nb">help </span>Get-IssuedCertificate -Parameter Properties

-Properties &lt;<span class="kt">String</span><span class="o">[]</span>&gt;
    Fields <span class="k">in </span>the Certificate Authority Database to Export

    Required?                    <span class="nb">false
    </span>Position?                    3
    Default value                <span class="o">(</span>
                <span class="s1">'Issued Common Name'</span>,
                <span class="s1">'Certificate Expiration Date'</span>,
                <span class="s1">'Certificate Effective Date'</span>,
                <span class="s1">'Certificate Template'</span>,
                <span class="c1">#'Issued Email Address',</span>
                <span class="s1">'Issued Request ID'</span>,
                <span class="s1">'Certificate Hash'</span>,
                <span class="c1">#'Request Disposition',</span>
                <span class="s1">'Request Disposition Message'</span>,
                <span class="s1">'Requester Name'</span>,
            <span class="s1">'Binary Certificate'</span> <span class="o">)</span>
    Accept pipeline input?       <span class="nb">false
    </span>Accept wildcard characters?  <span class="nb">false</span></code></pre></figure>

<p>For collecting the Certificates I only need the ‘Issued Common Name’ and ‘Binary Certificate’</p>

<figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="o">[</span>hv01]: <span class="o">[</span>Cli1]: <span class="nb">PS </span>C:<span class="se">\&gt;</span> <span class="nv">$DSCCerts</span> <span class="o">=</span> Get-IssuedCertificate -CertificateTemplateOid <span class="o">(</span>Get-CertificateTemplateOID -Name <span class="s1">'DSC
Template'</span><span class="o">)</span> -Properties <span class="s1">'Issued Common Name'</span>, <span class="s1">'Binary Certificate'</span>
<span class="o">[</span>hv01]: <span class="o">[</span>Cli1]: <span class="nb">PS </span>C:<span class="se">\&gt;</span>
<span class="o">[</span>hv01]: <span class="o">[</span>Cli1]: <span class="nb">PS </span>C:<span class="se">\&gt;</span> <span class="nv">$DSCCerts</span>.Count
4</code></pre></figure>

<p>So that got me 4 certs. Now I can step through each one and save them.</p>

<figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="o">[</span>hv01]: <span class="o">[</span>Cli1]: <span class="nb">PS </span>C:<span class="se">\&gt;</span> mkdir c:<span class="se">\c</span>erts


    Directory: C:<span class="se">\</span>


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-----        4/21/2017   7:12 AM                certs


<span class="o">[</span>hv01]: <span class="o">[</span>Cli1]: <span class="nb">PS </span>C:<span class="se">\&gt;</span> <span class="k">foreach</span> <span class="o">(</span><span class="nv">$cert</span> <span class="k">in</span> <span class="nv">$DSCCerts</span><span class="o">)</span>
<span class="gp">&gt;&gt; </span><span class="o">{</span>
<span class="gp">&gt;&gt;     </span><span class="nb">set-content</span> -path <span class="s2">"c:</span><span class="se">\c</span><span class="s2">erts</span><span class="se">\$</span><span class="s2">(</span><span class="nv">$cert</span><span class="s2">.'Issued Common Name').cer"</span> -Value <span class="nv">$cert</span>.<span class="s1">'Binary Certificate'</span> -Encoding Ascii
<span class="gp">&gt;&gt; </span><span class="o">}</span>
<span class="o">[</span>hv01]: <span class="o">[</span>Cli1]: <span class="nb">PS </span>C:<span class="se">\&gt;</span> <span class="nb">dir </span>c:<span class="se">\c</span>erts


    Directory: C:<span class="se">\c</span>erts


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----        4/21/2017   7:12 AM           1982 Cli1.Company.Pri.cer
-a----        4/21/2017   7:12 AM           1978 DC1.Company.Pri.cer
-a----        4/21/2017   7:12 AM           1972 S1.Company.Pri.cer
-a----        4/21/2017   7:12 AM           1972 S2.Company.Pri.cer</code></pre></figure>

<p>Now I have the certificate files for each node I can use for DSC.</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="https://blog.bladefirelight.com/tags/dsc" class="page__taxonomy-item" rel="tag">DSC</a><span class="sep">, </span>
    
      
      
      <a href="https://blog.bladefirelight.com/tags/pki" class="page__taxonomy-item" rel="tag">PKI</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="https://blog.bladefirelight.com/nuggets" class="page__taxonomy-item" rel="tag">Nuggets</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Updated:</strong> <time datetime="2017-04-21T00:00:00-05:00">April 21, 2017</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?via=BladeFireLight&text=Collecting CA Certificates for DSC Configuration https://blog.bladefirelight.com/nuggets/collecting-ca-certificates-for-dsc-configuration/" class="btn btn--twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https://blog.bladefirelight.com/nuggets/collecting-ca-certificates-for-dsc-configuration/" class="btn btn--facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=https://blog.bladefirelight.com/nuggets/collecting-ca-certificates-for-dsc-configuration/" class="btn btn--google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://blog.bladefirelight.com/nuggets/collecting-ca-certificates-for-dsc-configuration/" class="btn btn--linkedin" title="Share on LinkedIn"><i class="fa fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="https://blog.bladefirelight.com/windowsimagetools/Creating-an-Updateed-Image-Part3-Updates/" class="pagination--pager" title="Windows Image Tools | Creating an Updated Image Part 3
">Previous</a>
    
    
      <a href="#" class="pagination--pager disabled">Next</a>
    
  </nav>

    </div>

    
      <div class="page__comments">
  
  

    <section id="static-comments">
      
      

        <!-- Start static comments -->
        <div id="comments" class="js-comments">

            <h4 class="page__comments-title">
              Comments
            </h4>
            

<!--            [{&quot;_id&quot;=&gt;&quot;62a283e0-e834-11e6-bf17-3b62c726cec1&quot;, &quot;message&quot;=&gt;&quot;test comment&quot;, &quot;name&quot;=&gt;&quot;David&quot;, &quot;email&quot;=&gt;&quot;fe92471d42dd25235f2fa0bb429e983b&quot;, &quot;hidden&quot;=&gt;&quot;&quot;, &quot;date&quot;=&gt;&quot;2017-02-01T04:10:37.608Z&quot;}, {&quot;_id&quot;=&gt;&quot;e8773a10-e834-11e6-bf17-3b62c726cec1&quot;, &quot;message&quot;=&gt;&quot;Test comment 2&quot;, &quot;name&quot;=&gt;&quot;David Jones&quot;, &quot;email&quot;=&gt;&quot;fe92471d42dd25235f2fa0bb429e983b&quot;, &quot;hidden&quot;=&gt;&quot;&quot;, &quot;date&quot;=&gt;&quot;2017-02-01T04:14:22.131Z&quot;}, {&quot;_id&quot;=&gt;&quot;50051610-e8a4-11e6-86ff-e7ada9208c07&quot;, &quot;message&quot;=&gt;&quot;uppercase email address&quot;, &quot;name&quot;=&gt;&quot;David Jones&quot;, &quot;email&quot;=&gt;&quot;BladeFireLight@outlook.com&quot;, &quot;hidden&quot;=&gt;&quot;&quot;, &quot;date&quot;=&gt;&quot;2017-02-01T17:31:49.945Z&quot;}, {&quot;_id&quot;=&gt;&quot;62eae2a0-e8a4-11e6-86ff-e7ada9208c07&quot;, &quot;message&quot;=&gt;&quot;Lowercase email address&quot;, &quot;name&quot;=&gt;&quot;David Jones&quot;, &quot;email&quot;=&gt;&quot;bladefirelight@outlook.com&quot;, &quot;hidden&quot;=&gt;&quot;&quot;, &quot;date&quot;=&gt;&quot;2017-02-01T17:32:21.670Z&quot;}, {&quot;_id&quot;=&gt;&quot;df7e0e40-e8af-11e6-86ff-e7ada9208c07&quot;, &quot;message&quot;=&gt;&quot;lowercase test&quot;, &quot;name&quot;=&gt;&quot;David Jones&quot;, &quot;email&quot;=&gt;&quot;14a298db4912733411bb8d3067b478bc&quot;, &quot;hidden&quot;=&gt;&quot;&quot;, &quot;date&quot;=&gt;&quot;2017-02-01T18:54:35.201Z&quot;}, {&quot;_id&quot;=&gt;&quot;e9ef7fc0-e8c4-11e6-86ff-e7ada9208c07&quot;, &quot;message&quot;=&gt;&quot;Mailgun test 1&quot;, &quot;name&quot;=&gt;&quot;David Jones&quot;, &quot;email&quot;=&gt;&quot;14a298db4912733411bb8d3067b478bc&quot;, &quot;hidden&quot;=&gt;&quot;&quot;, &quot;date&quot;=&gt;&quot;2017-02-01T21:25:12.202Z&quot;}, {&quot;_id&quot;=&gt;&quot;12bfa650-e8c5-11e6-86ff-e7ada9208c07&quot;, &quot;message&quot;=&gt;&quot;test email 2&quot;, &quot;name&quot;=&gt;&quot;David Jones&quot;, &quot;email&quot;=&gt;&quot;14a298db4912733411bb8d3067b478bc&quot;, &quot;hidden&quot;=&gt;&quot;&quot;, &quot;date&quot;=&gt;&quot;2017-02-01T21:26:20.572Z&quot;}]    -->

            

              
              
              

              
              
              
              
              
              
              
              

              <article id="comment-1" class="js-comment comment  " itemprop="comment" itemscope itemtype="http://schema.org/Comment">

  <div class="comment__avatar-wrapper">
    
      <img src="https://www.gravatar.com/avatar/fe92471d42dd25235f2fa0bb429e983b?d=mm&s=60" srcset="https://www.gravatar.com/avatar/fe92471d42dd25235f2fa0bb429e983b?d=mm&s=120 2x" alt="David">
    
  </div>

  <h3 class="comment__author" itemprop="author" itemscope itemtype="http://schema.org/Person">
    
      <span itemprop="name">David</span>
    
  </h3>

  <div class="comment__date">
    
      <a href="#comment-1" title="Permalink to this comment" itemprop="url">
      <time datetime="2017-01-31T22:10:37-06:00" itemprop="datePublished">February 01, 2017 at 04:10 AM</time>
      </a>
    
  </div>

  <div class="comment__message" itemprop="text"><p>test comment</p>
</div>

  
  <div class="comment__reply">
    <a rel="nofollow" class="btn" href="#comment-1" onclick="return addComment.moveForm('comment-1', '1', 'respond', 'collecting-ca-certificates-for-dsc-configuration')">Reply to David</a>
  </div>
  

</article>






            

              
              
              

              
              
              
              
              
              
              
              

              <article id="comment-2" class="js-comment comment admin " itemprop="comment" itemscope itemtype="http://schema.org/Comment">

  <div class="comment__avatar-wrapper">
    
      <img src="https://www.gravatar.com/avatar/fe92471d42dd25235f2fa0bb429e983b?d=mm&s=60" srcset="https://www.gravatar.com/avatar/fe92471d42dd25235f2fa0bb429e983b?d=mm&s=120 2x" alt="David Jones">
    
  </div>

  <h3 class="comment__author" itemprop="author" itemscope itemtype="http://schema.org/Person">
    
      <span itemprop="name">David Jones</span>
    
  </h3>

  <div class="comment__date">
    
      <a href="#comment-2" title="Permalink to this comment" itemprop="url">
      <time datetime="2017-01-31T22:14:22-06:00" itemprop="datePublished">February 01, 2017 at 04:14 AM</time>
      </a>
    
  </div>

  <div class="comment__message" itemprop="text"><p>Test comment 2</p>
</div>

  
  <div class="comment__reply">
    <a rel="nofollow" class="btn" href="#comment-2" onclick="return addComment.moveForm('comment-2', '2', 'respond', 'collecting-ca-certificates-for-dsc-configuration')">Reply to David Jones</a>
  </div>
  

</article>






            

              
              
              

              
              
              
              
              
              
              
              

              <article id="comment-3" class="js-comment comment admin " itemprop="comment" itemscope itemtype="http://schema.org/Comment">

  <div class="comment__avatar-wrapper">
    
      <img src="https://www.gravatar.com/avatar/BladeFireLight@outlook.com?d=mm&s=60" srcset="https://www.gravatar.com/avatar/BladeFireLight@outlook.com?d=mm&s=120 2x" alt="David Jones">
    
  </div>

  <h3 class="comment__author" itemprop="author" itemscope itemtype="http://schema.org/Person">
    
      <span itemprop="name">David Jones</span>
    
  </h3>

  <div class="comment__date">
    
      <a href="#comment-3" title="Permalink to this comment" itemprop="url">
      <time datetime="2017-02-01T11:31:49-06:00" itemprop="datePublished">February 01, 2017 at 05:31 PM</time>
      </a>
    
  </div>

  <div class="comment__message" itemprop="text"><p>uppercase email address</p>
</div>

  
  <div class="comment__reply">
    <a rel="nofollow" class="btn" href="#comment-3" onclick="return addComment.moveForm('comment-3', '3', 'respond', 'collecting-ca-certificates-for-dsc-configuration')">Reply to David Jones</a>
  </div>
  

</article>






            

              
              
              

              
              
              
              
              
              
              
              

              <article id="comment-4" class="js-comment comment admin " itemprop="comment" itemscope itemtype="http://schema.org/Comment">

  <div class="comment__avatar-wrapper">
    
      <img src="https://www.gravatar.com/avatar/bladefirelight@outlook.com?d=mm&s=60" srcset="https://www.gravatar.com/avatar/bladefirelight@outlook.com?d=mm&s=120 2x" alt="David Jones">
    
  </div>

  <h3 class="comment__author" itemprop="author" itemscope itemtype="http://schema.org/Person">
    
      <span itemprop="name">David Jones</span>
    
  </h3>

  <div class="comment__date">
    
      <a href="#comment-4" title="Permalink to this comment" itemprop="url">
      <time datetime="2017-02-01T11:32:21-06:00" itemprop="datePublished">February 01, 2017 at 05:32 PM</time>
      </a>
    
  </div>

  <div class="comment__message" itemprop="text"><p>Lowercase email address</p>
</div>

  
  <div class="comment__reply">
    <a rel="nofollow" class="btn" href="#comment-4" onclick="return addComment.moveForm('comment-4', '4', 'respond', 'collecting-ca-certificates-for-dsc-configuration')">Reply to David Jones</a>
  </div>
  

</article>






            

              
              
              

              
              
              
              
              
              
              
              

              <article id="comment-5" class="js-comment comment admin " itemprop="comment" itemscope itemtype="http://schema.org/Comment">

  <div class="comment__avatar-wrapper">
    
      <img src="https://www.gravatar.com/avatar/14a298db4912733411bb8d3067b478bc?d=mm&s=60" srcset="https://www.gravatar.com/avatar/14a298db4912733411bb8d3067b478bc?d=mm&s=120 2x" alt="David Jones">
    
  </div>

  <h3 class="comment__author" itemprop="author" itemscope itemtype="http://schema.org/Person">
    
      <span itemprop="name">David Jones</span>
    
  </h3>

  <div class="comment__date">
    
      <a href="#comment-5" title="Permalink to this comment" itemprop="url">
      <time datetime="2017-02-01T12:54:35-06:00" itemprop="datePublished">February 01, 2017 at 06:54 PM</time>
      </a>
    
  </div>

  <div class="comment__message" itemprop="text"><p>lowercase test</p>
</div>

  
  <div class="comment__reply">
    <a rel="nofollow" class="btn" href="#comment-5" onclick="return addComment.moveForm('comment-5', '5', 'respond', 'collecting-ca-certificates-for-dsc-configuration')">Reply to David Jones</a>
  </div>
  

</article>




  
  
  
  
  
  
  
  
  
  
  
  <article id="comment-5-1" class="js-comment comment  child" itemprop="comment" itemscope itemtype="http://schema.org/Comment">

  <div class="comment__avatar-wrapper">
    
      <img src="https://www.gravatar.com/avatar/14a298db4912733411bb8d3067b478bc?d=mm&s=60" srcset="https://www.gravatar.com/avatar/14a298db4912733411bb8d3067b478bc?d=mm&s=120 2x" alt="David">
    
  </div>

  <h3 class="comment__author" itemprop="author" itemscope itemtype="http://schema.org/Person">
    
      <span itemprop="name">David</span>
    
  </h3>

  <div class="comment__date">
    
      <a href="#comment-5-1" title="Permalink to this comment" itemprop="url">
      <time datetime="2017-02-01T13:45:48-06:00" itemprop="datePublished">February 01, 2017 at 07:45 PM</time>
      </a>
    
  </div>

  <div class="comment__message" itemprop="text"><p>test reply</p>
</div>

  

</article>








            

              
              
              

              
              
              
              
              
              
              
              

              <article id="comment-6" class="js-comment comment admin " itemprop="comment" itemscope itemtype="http://schema.org/Comment">

  <div class="comment__avatar-wrapper">
    
      <img src="https://www.gravatar.com/avatar/14a298db4912733411bb8d3067b478bc?d=mm&s=60" srcset="https://www.gravatar.com/avatar/14a298db4912733411bb8d3067b478bc?d=mm&s=120 2x" alt="David Jones">
    
  </div>

  <h3 class="comment__author" itemprop="author" itemscope itemtype="http://schema.org/Person">
    
      <span itemprop="name">David Jones</span>
    
  </h3>

  <div class="comment__date">
    
      <a href="#comment-6" title="Permalink to this comment" itemprop="url">
      <time datetime="2017-02-01T15:25:12-06:00" itemprop="datePublished">February 01, 2017 at 09:25 PM</time>
      </a>
    
  </div>

  <div class="comment__message" itemprop="text"><p>Mailgun test 1</p>
</div>

  
  <div class="comment__reply">
    <a rel="nofollow" class="btn" href="#comment-6" onclick="return addComment.moveForm('comment-6', '6', 'respond', 'collecting-ca-certificates-for-dsc-configuration')">Reply to David Jones</a>
  </div>
  

</article>






            

              
              
              

              
              
              
              
              
              
              
              

              <article id="comment-7" class="js-comment comment admin " itemprop="comment" itemscope itemtype="http://schema.org/Comment">

  <div class="comment__avatar-wrapper">
    
      <img src="https://www.gravatar.com/avatar/14a298db4912733411bb8d3067b478bc?d=mm&s=60" srcset="https://www.gravatar.com/avatar/14a298db4912733411bb8d3067b478bc?d=mm&s=120 2x" alt="David Jones">
    
  </div>

  <h3 class="comment__author" itemprop="author" itemscope itemtype="http://schema.org/Person">
    
      <span itemprop="name">David Jones</span>
    
  </h3>

  <div class="comment__date">
    
      <a href="#comment-7" title="Permalink to this comment" itemprop="url">
      <time datetime="2017-02-01T15:26:20-06:00" itemprop="datePublished">February 01, 2017 at 09:26 PM</time>
      </a>
    
  </div>

  <div class="comment__message" itemprop="text"><p>test email 2</p>
</div>

  
  <div class="comment__reply">
    <a rel="nofollow" class="btn" href="#comment-7" onclick="return addComment.moveForm('comment-7', '7', 'respond', 'collecting-ca-certificates-for-dsc-configuration')">Reply to David Jones</a>
  </div>
  

</article>






            
          </div>
          <!-- End static comments -->
        


        



        <!-- Start new comment form -->
        <div id="respond">
        <h2 class="page__comments-title">
          Leave a Comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://blog.bladefirelight.com/nuggets/collecting-ca-certificates-for-dsc-configuration/#respond" style="display:none;">Cancel reply</a></small>
        </h2>

        <p class="small">Your email address will not be published. Required fields are marked <span class="required">*</span></p>

        <form id="new_comment" class="page__comments-form js-form form" method="post" action="https://api.staticman.net/v2/entry/BladeFireLight/blog_source/master/comments">

          <div class="form__spinner">
            <i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>
            <span class="sr-only">Loading...</span>
          </div>

          <fieldset>
            <label for="comment-form-message">Comment <small class="required">*</small></label>
            <textarea type="text" rows="3" id="comment-form-message" name="fields[message]" tabindex="1"></textarea>
            <div class="small help-block"><a href="https://daringfireball.net/projects/markdown/">Markdown is supported.</a></div>
          </fieldset>
          <fieldset>
            <label for="comment-form-name">Name <small class="required">*</small></label>
            <input type="text" id="comment-form-name" name="fields[name]" tabindex="2" />
          </fieldset>
          <fieldset>
            <label for="comment-form-email">Email address <small class="required">*</small></label>
            <input type="email" id="comment-form-email" name="fields[email]" tabindex="3" />
          </fieldset>
<!--          <fieldset>
            <label for="comment-form-url">Website (optional)</label>
            <input type="url" id="comment-form-url" name="fields[url]" tabindex="4"/>
          </fieldset> -->
          <fieldset class="hidden" style="display: none;">
            <input type="hidden" name="options[origin]" value="https://blog.bladefirelight.com/nuggets/collecting-ca-certificates-for-dsc-configuration/">
            <input type="hidden" id="comment-parent" name="options[parent]" value="">
            <input type="hidden" id="comment-post-id" name="options[slug]" value="collecting-ca-certificates-for-dsc-configuration">
            <label for="comment-form-location">Not used. Leave blank if you are a human.</label>
            <input type="text" id="comment-form-location" name="fields[hidden]" autocomplete="off"/>
          </fieldset>
          <!-- Start comment form alert messaging -->
          <p class="hidden js-notice">
            <strong class="js-notice-text"></strong>
          </p>
          <!-- End comment form alert messaging -->
          <fieldset>
            <label for="comment-form-reply"><input type="checkbox" id="comment-form-reply" name="options[subscribe]" value="email">&nbsp;Notify me of new comments by email.</label>
            <button type="submit" id="comment-form-submit" tabindex="5" class="btn btn--large">Submit Comment</button>
          </fieldset>

        </form>
      </div>
      <!-- End new comment form -->
      
    
  </section>
  
</div>

    
  </article>

  
  
    <div class="page__related">
      
        <h4 class="page__related-title">You May Also Enjoy</h4>
      
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "https://blog.bladefirelight.com/assets/images/default-teaser.png"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="https://blog.bladefirelight.com/windowsimagetools/Creating-an-Updateed-Image-Part3-Updates/" rel="permalink">Windows Image Tools | Creating an Updated Image Part 3
</a>
      
    </h2>
    
      <p class="page__meta">
      
        <i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Updated: <time datetime="2016-10-12T16:48:59-05:00">October 12, 2016</time>
      
      
       - 
       <i class="fa fa-clock-o" aria-hidden="true"></i> 




  less than 1 minute read

      
      </p>
    
    <p class="archive__item-excerpt" itemprop="description">One of the time consuming steps to deploying new VMs is the time spend managing Images and and applying patches. I’m not big on Golden images. I tend to use ...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "https://blog.bladefirelight.com/assets/images/default-teaser.png"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="https://blog.bladefirelight.com/windowsimagetools/Creating-an-Updateed-Image-Part2-WMF5/" rel="permalink">Windows Image Tools | Creating an Updated Image Part 2
</a>
      
    </h2>
    
      <p class="page__meta">
      
        <i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Updated: <time datetime="2016-09-01T16:48:59-05:00">September 01, 2016</time>
      
      
       - 
       <i class="fa fa-clock-o" aria-hidden="true"></i> 




  4 minute read

      
      </p>
    
    <p class="archive__item-excerpt" itemprop="description">One of the time consuming steps to deploying new VMs is the time spend managing Images and and applying patches. I’m not big on Golden images. I tend to use ...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "https://blog.bladefirelight.com/assets/images/default-teaser.png"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="https://blog.bladefirelight.com/windowsimagetools/Creating-an-Updateed-Image-Part1-Base-VHDX/" rel="permalink">Windows Image Tools | Creating an Updated Image Part 1
</a>
      
    </h2>
    
      <p class="page__meta">
      
        <i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Updated: <time datetime="2016-09-01T16:48:59-05:00">September 01, 2016</time>
      
      
       - 
       <i class="fa fa-clock-o" aria-hidden="true"></i> 




  3 minute read

      
      </p>
    
    <p class="archive__item-excerpt" itemprop="description">One of the time consuming steps to deploying new VMs is the time spend managing Images and and applying patches. I’m not big on Golden images. I tend to use ...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src=
          
            "https://blog.bladefirelight.com/assets/images/default-teaser.png"
          
          alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="https://blog.bladefirelight.com/Blog-Refactoring/" rel="permalink">Re-factoring the Blog
</a>
      
    </h2>
    
      <p class="page__meta">
      
        <i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Updated: <time datetime="2016-09-01T00:00:00-05:00">September 01, 2016</time>
      
      
       - 
       <i class="fa fa-clock-o" aria-hidden="true"></i> 




  1 minute read

      
      </p>
    
    <p class="archive__item-excerpt" itemprop="description">Sometimes rebooting fixes everything

</p>
  </article>
</div>

        
      </div>
    </div>
  
</div>


    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
      <li><a href="https://twitter.com/BladeFireLight"><i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
    
    
    
    
    
      <li><a href="https://github.com/BladeFireLight"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    
    <li><a href="https://blog.bladefirelight.com/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2017 David Jones. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>
      </footer>
    </div>

    <script src="https://blog.bladefirelight.com/assets/js/main.min.js" type="text/javascript" charset="utf-8"></script>
<script src="https://blog.bladefirelight.com/assets/js/staticman.js" type="text/javascript" charset="utf-8"></script>

<!-- If viewing the search page, include Lunr scripts -->







  
  <script>
    (function ($) {
    var $comments = $('.js-comments');

    $('#new_comment').submit(function () {
      var form = this;

      $(form).addClass('disabled');
      $('#comment-form-submit').html('<i class="fa fa-spinner fa-spin fa-fw"></i> Loading...');

      $.ajax({
        type: $(this).attr('method'),
        url: $(this).attr('action'),
        data: $(this).serialize(),
        contentType: 'application/x-www-form-urlencoded',
        success: function (data) {
          $('#comment-form-submit').html('Submitted');
          $('.page__comments-form .js-notice').removeClass('notice--danger');
          $('.page__comments-form .js-notice').addClass('notice--success');
          showAlert('Thanks for your comment! It will show on the site once it has been approved.');
        },
        error: function (err) {
          console.log(err);
          $('#comment-form-submit').html('Submit Comment');
          $('.page__comments-form .js-notice').removeClass('notice--success');
          $('.page__comments-form .js-notice').addClass('notice--danger');
          showAlert('Sorry, there was an error with your submission. Please make sure all required fields have been completed and try again.');
          $(form).removeClass('disabled');
        }
      });

      return false;
    });

    function showAlert(message) {
      $('.page__comments-form .js-notice').removeClass('hidden');
      $('.page__comments-form .js-notice-text').html(message);
    }
  })(jQuery);

  var addComment = {
  moveForm: function( commId, parentId, respondId, postId ) {
    var div, element, style, cssHidden,
      t           = this,
      comm        = t.I( commId ),
      respond     = t.I( respondId ),
      cancel      = t.I( 'cancel-comment-reply-link' ),
      parent      = t.I( 'comment-parent' ),
      post        = t.I( 'comment-post-slug' ),
      commentForm = respond.getElementsByTagName( 'form' )[0];

    if ( ! comm || ! respond || ! cancel || ! parent || ! commentForm ) {
      return;
    }

    t.respondId = respondId;
    postId = postId || false;

    if ( ! t.I( 'sm-temp-form-div' ) ) {
      div = document.createElement( 'div' );
      div.id = 'sm-temp-form-div';
      div.style.display = 'none';
      respond.parentNode.insertBefore( div, respond );
    }

    comm.parentNode.insertBefore( respond, comm.nextSibling );
    if ( post && postId ) {
      post.value = postId;
    }
    parent.value = parentId;
    cancel.style.display = '';

    cancel.onclick = function() {
      var t       = addComment,
        temp    = t.I( 'sm-temp-form-div' ),
        respond = t.I( t.respondId );

      if ( ! temp || ! respond ) {
        return;
      }

      t.I( 'comment-parent' ).value = '0';
      temp.parentNode.insertBefore( respond, temp );
      temp.parentNode.removeChild( temp );
      this.style.display = 'none';
      this.onclick = null;
      return false;
    };

    /*
     * Set initial focus to the first form focusable element.
     * Try/catch used just to avoid errors in IE 7- which return visibility
     * 'inherit' when the visibility value is inherited from an ancestor.
     */
    try {
      for ( var i = 0; i < commentForm.elements.length; i++ ) {
        element = commentForm.elements[i];
        cssHidden = false;

        // Modern browsers.
        if ( 'getComputedStyle' in window ) {
          style = window.getComputedStyle( element );
        // IE 8.
        } else if ( document.documentElement.currentStyle ) {
          style = element.currentStyle;
        }

        /*
         * For display none, do the same thing jQuery does. For visibility,
         * check the element computed style since browsers are already doing
         * the job for us. In fact, the visibility computed style is the actual
         * computed value and already takes into account the element ancestors.
         */
        if ( ( element.offsetWidth <= 0 && element.offsetHeight <= 0 ) || style.visibility === 'hidden' ) {
          cssHidden = true;
        }

        // Skip form elements that are hidden or disabled.
        if ( 'hidden' === element.type || element.disabled || cssHidden ) {
          continue;
        }

        element.focus();
        // Stop after the first focusable element.
        break;
      }

    } catch( er ) {}

    return false;
  },

  I: function( id ) {
    return document.getElementById( id );
  }
};
</script>








  </body>
</html>

